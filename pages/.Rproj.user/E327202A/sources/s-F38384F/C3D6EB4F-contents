
library(rgdal)
library(link2GI)
library(mapview)
library(raster)
library(RColorBrewer)
library(geojsonio)
library(rmapshaper)
library(spdplyr)
library(magrittr)
library(leaflet)
species2 = readOGR("../assets/maps/mof_realdata.shp")
nam = readRDS("../assets/maps/labels_crowns.rds")
names(species) = nam

# convert to geojson
species_geojso = geojson_json(species)
# simplifiy shapes
species_gj_simple = ms_simplify(species_geojso)
geojson_write(species_gj_simple,file="B:/mof_caldern/assets/maps/mof_simple.geojson", geometry = "polygon")



species = geojson_read("../assets/maps/mof_simple.geojson", what = "sp")
species = readOGR("../assets/maps/mof_simple.geojson",layer = "mof_simple")
nam = readRDS("../assets/maps/labels_crowns.rds")
names(species) = nam
proj4string(species) = "+proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs"



redgreen = grDevices::colorRampPalette(c("red","green"))
m = mapview::mapview(species, zcol = c("quality"),
                 color = "black",
                 at = seq(25,100,5),
                 col.regions = redgreen(16),
                 na.color = "grey",
                 lwd = 0.1,
                 legend = TRUE,
                 layer.name = "Quality of Classification")

mapshot(m,url="quality_test.html")

m = leaflet(species_gj_simple) %>%
  addTiles() 
m  




